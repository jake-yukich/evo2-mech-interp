accession_ids = [
    "GB_GCA_013297995.1",
    "GB_GCA_903908015.1",
    "RS_GCF_004342685.1",
    "GB_GCA_902763505.1",
    "GB_GCA_017616785.1",
    "RS_GCF_004799445.1",
    "GB_GCA_017940465.1",
    "GB_GCA_003576845.1",
    "GB_GCA_003645645.1",
    "RS_GCF_018130545.1",
    "GB_GCA_016787525.1",
    "GB_GCA_016931155.1",
    "GB_GCA_023387695.1",
    "GB_GCA_013334735.1",
    "GB_GCA_902598655.1",
    "GB_GCA_004562765.1",
    "GB_GCA_012522475.1",
    "RS_GCF_014201615.1",
    "GB_GCA_015059955.1",
    "RS_GCF_008014775.1",
    "RS_GCF_018882295.1",
    "GB_GCA_018971925.1",
    "GB_GCA_017455665.1",
    "RS_GCF_005116645.1",
    "GB_GCA_003216035.1",
    "GB_GCA_002877875.1",
    "GB_GCA_017646625.1",
    "GB_GCA_022764445.1",
    "RS_GCF_012911005.2",
    "RS_GCF_023016045.1",
    "RS_GCF_004208415.1",
    "RS_GCF_000807855.2",
    "RS_GCF_944387805.1",
    "GB_GCA_021776195.1",
    "GB_GCA_016779605.1",
    "GB_GCA_015058045.1",
    "GB_GCA_024693775.1",
    "RS_GCF_013822795.1",
    "RS_GCF_900155475.1",
    "GB_GCA_003175865.1",
    "GB_GCA_902567115.1",
    "GB_GCA_017412245.1",
    "GB_GCA_018062985.1",
    "GB_GCA_016783565.1",
    "GB_GCA_003564295.1",
    "GB_GCA_023382975.1",
    "GB_GCA_017531625.1",
    "GB_GCA_009785395.1",
    "RS_GCF_000426845.1",
    "RS_GCF_900184935.1",
    "GB_GCA_013213785.1",
    "GB_GCA_002238585.1",
    "GB_GCA_934248055.1",
    "GB_GCA_024707145.1",
    "GB_GCA_022819945.1",
    "GB_GCA_023301395.1",
    "GB_GCA_902784165.1",
    "GB_GCA_023700985.1",
    "GB_GCA_902616675.1",
    "GB_GCA_004376575.1",
    "GB_GCA_022768065.1",
    "GB_GCA_934757245.1",
    "GB_GCA_017380615.1",
    "GB_GCA_024684055.1",
    "RS_GCF_011392075.1",
    "GB_GCA_902604525.1",
    "GB_GCA_019873625.1",
    "RS_GCF_001720165.1",
    "GB_GCA_016795255.1",
    "GB_GCA_020847975.1",
    "GB_GCA_020631675.1",
    "GB_GCA_944376335.1",
    "GB_GCA_015489295.1",
    "GB_GCA_012727535.1",
    "GB_GCA_913057815.1",
    "GB_GCA_021298595.1",
    "GB_GCA_902597865.1",
    "GB_GCA_025057395.1",
    "RS_GCF_000685315.1",
    "RS_GCF_004088395.1",
    "GB_GCA_024402755.1",
    "GB_GCA_945888325.1",
    "GB_GCA_016219515.1",
    "RS_GCF_018390515.1",
    "GB_GCA_903899885.1",
    "GB_GCA_937915455.1",
    "GB_GCA_017476165.1",
    "GB_GCA_012517195.1",
    "RS_GCF_001940235.1",
    "GB_GCA_025057205.1",
    "RS_GCF_009848685.1",
    "GB_GCA_902611605.1",
    "GB_GCA_023260135.1",
    "GB_GCA_018241965.1",
    "GB_GCA_024277705.1",
    "GB_GCA_902621165.1",
    "GB_GCA_020024185.1",
    "GB_GCA_002170485.2",
    "GB_GCA_012799455.1",
    "GB_GCA_021083345.1",
    "GB_GCA_017551845.1",
    "RS_GCF_019042215.1",
    "GB_GCA_016188005.1",
    "GB_GCA_002382735.1",
    "GB_GCA_021736525.1",
    "RS_GCF_900176415.1",
    "GB_GCA_016649875.1",
    "RS_GCF_002250505.1",
    "GB_GCA_902537415.1",
    "RS_GCF_002428305.1",
    "GB_GCA_016872835.1",
    "GB_GCA_913044235.1",
    "GB_GCA_003561025.1",
    "GB_GCA_024226515.1",
    "GB_GCA_024685635.1",
    "GB_GCA_020632715.1",
    "RS_GCF_015207525.1",
    "GB_GCA_944327215.1",
    "GB_GCA_018333725.1",
    "RS_GCF_002646595.1",
    "GB_GCA_016218975.1",
    "RS_GCF_020866965.1",
    "GB_GCA_005878685.1",
    "GB_GCA_017521965.1",
    "GB_GCA_013911745.1",
    "GB_GCA_016200495.1",
    "GB_GCA_003194495.1",
    "GB_GCA_023398495.1",
    "GB_GCA_003978135.1",
    "GB_GCA_002070645.1",
    "GB_GCA_934149005.1",
    "GB_GCA_003559065.1",
    "GB_GCA_902557995.1",
    "GB_GCA_003220265.1",
    "RS_GCF_013170805.1",
    "GB_GCA_016867415.1",
    "GB_GCA_002238885.1",
    "GB_GCA_944327295.1",
    "RS_GCF_000473895.1",
    "GB_GCA_011525845.1",
    "GB_GCA_017396365.1",
    "GB_GCA_017940005.1",
    "GB_GCA_003670745.1",
    "GB_GCA_002696965.1",
    "GB_GCA_005789005.1",
    "GB_GCA_000961595.1",
    "RS_GCF_020171465.1",
    "GB_GCA_902600475.1",
    "GB_GCA_016871815.1",
    "RS_GCF_002899825.2",
    "RS_GCF_024970065.1",
    "GB_GCA_017555205.1",
    "GB_GCA_024232495.1",
    "GB_GCA_016795005.1",
    "GB_GCA_017403185.1",
    "GB_GCA_017442585.1",
    "GB_GCA_019637585.1",
    "RS_GCF_021601385.1",
    "RS_GCF_000497755.1",
    "GB_GCA_002732805.1",
    "GB_GCA_900769845.1",
    "GB_GCA_002474345.1",
    "GB_GCA_023458595.1",
    "GB_GCA_015231915.1",
    "GB_GCA_022793655.1",
    "RS_GCF_003122085.1",
    "GB_GCA_017614095.1",
    "RS_GCF_004769195.1",
    "RS_GCF_015709455.1",
    "GB_GCA_019634125.1",
    "GB_GCA_934717745.1",
    "GB_GCA_025062135.1",
    "GB_GCA_017381935.1",
    "GB_GCA_021731185.1",
    "GB_GCA_019090295.1",
    "GB_GCA_902594705.1",
    "GB_GCA_017391675.1",
    "GB_GCA_017990895.1",
    "RS_GCF_002282565.1",
    "GB_GCA_944393685.1",
    "GB_GCA_019752045.1",
    "GB_GCA_018830885.1",
    "GB_GCA_002167265.1",
    "RS_GCF_904846315.1",
    "GB_GCA_003556525.1",
    "GB_GCA_012800475.1",
    "GB_GCA_902525935.1",
    "GB_GCA_011330685.1",
    "RS_GCF_019431455.1",
    "GB_GCA_905221145.1",
    "RS_GCF_000287675.1",
    "RS_GCF_900129505.1",
    "GB_GCA_015069565.1",
    "GB_GCA_004295885.1",
    "RS_GCF_016807805.1",
    "GB_GCA_024636775.1",
    "GB_GCA_020721165.1",
    "GB_GCA_005882275.1",
    "RS_GCF_001990265.1",
    "GB_GCA_017545665.1",
    "GB_GCA_023255275.1",
    "RS_GCF_004123905.1",
    "GB_GCA_017414605.1",
    "GB_GCA_003165455.1",
    "GB_GCA_017629145.1",
    "GB_GCA_021813685.1",
    "RS_GCF_900156105.1",
    "GB_GCA_944320195.1",
    "GB_GCA_945902115.1",
    "GB_GCA_021741205.1",
    "GB_GCA_017550895.1",
    "RS_GCF_001494635.1",
    "GB_GCA_905479195.1",
    "GB_GCA_017881985.1",
    "RS_GCF_013033965.1",
    "GB_GCA_902538885.1",
    "GB_GCA_002694035.1",
    "GB_GCA_913776615.1",
    "GB_GCA_014238315.1",
    "RS_GCF_011189575.1",
    "GB_GCA_017503065.1",
    "GB_GCA_017507125.1",
    "GB_GCA_012522435.1",
    "RS_GCF_900103195.1",
    "GB_GCA_017627255.1",
    "GB_GCA_005110385.1",
    "GB_GCA_005772945.1",
    "GB_GCA_009911195.1",
    "GB_GCA_022508585.1",
    "GB_GCA_903866915.1",
    "GB_GCA_017461765.1",
    "GB_GCA_016787645.1",
    "GB_GCA_020524245.1",
    "GB_GCA_002385265.1",
    "GB_GCA_944391725.1",
    "GB_GCA_017513095.1",
    "GB_GCA_021324935.1",
    "GB_GCA_020057805.1",
    "GB_GCA_903929655.1",
    "GB_GCA_016209535.1",
    "GB_GCA_902612805.1",
    "GB_GCA_944386225.1",
    "GB_GCA_012841635.1",
    "GB_GCA_016764475.1",
    "GB_GCA_019634835.1",
    "GB_GCA_017462425.1",
    "GB_GCA_023145975.1",
    "GB_GCA_020723305.1",
    "GB_GCA_945285915.1",
    "GB_GCA_017539765.1",
    "RS_GCF_002266285.1",
    "GB_GCA_021777635.1",
    "GB_GCA_021156175.1",
    "GB_GCA_017446055.1",
    "GB_GCA_017408735.1",
    "GB_GCA_001872545.1",
    "GB_GCA_016715075.1",
    "GB_GCA_020725085.1",
    "GB_GCA_945881875.1",
    "RS_GCF_014023275.1",
    "GB_GCA_020832235.1",
    "GB_GCA_002746685.1",
    "RS_GCF_900141735.1",
    "GB_GCA_020629275.1",
    "GB_GCA_900766645.1",
    "RS_GCF_900890705.1",
    "GB_GCA_024280155.1",
    "GB_GCA_017554565.1",
    "GB_GCA_024233115.1",
    "GB_GCA_009691305.1",
    "GB_GCA_017964755.1",
    "GB_GCA_017631955.1",
    "RS_GCF_003063245.1",
    "GB_GCA_945867435.1",
    "GB_GCA_018433675.1",
    "GB_GCA_016282745.1",
    "RS_GCF_900112455.1",
    "GB_GCA_017416345.1",
    "GB_GCA_937984005.1",
    "GB_GCA_029932605.1",
    "GB_GCA_022710485.1",
    "GB_GCA_002430925.1",
    "GB_GCA_003476685.1",
    "GB_GCA_019912965.1",
    "GB_GCA_934376945.1",
    "GB_GCA_017398695.1",
    "GB_GCA_903642235.1",
    "GB_GCA_021443415.1",
    "GB_GCA_022511055.1",
    "GB_GCA_900542675.1",
    "GB_GCA_944392265.1",
    "GB_GCA_002928515.1",
    "RS_GCF_011043525.1",
    "RS_GCF_003991975.1",
    "RS_GCF_900637665.1",
    "GB_GCA_902535565.1",
    "GB_GCA_005240105.1",
    "GB_GCA_944323735.1",
    "RS_GCF_017316125.1",
    "GB_GCA_017413085.1",
    "RS_GCF_022832975.1",
    "GB_GCA_017433245.1",
    "GB_GCA_900317425.1",
    "RS_GCF_007859815.1",
    "GB_GCA_012838085.1",
    "GB_GCA_002314605.1",
    "GB_GCA_007116585.1",
    "GB_GCA_902572925.1",
    "GB_GCA_019745975.1",
    "GB_GCA_016780435.1",
    "GB_GCA_001777055.1",
    "RS_GCF_007997015.1",
    "GB_GCA_017553205.1",
    "GB_GCA_012962595.1",
    "GB_GCA_002746605.1",
    "RS_GCF_001644565.1",
    "GB_GCA_902406155.1",
    "GB_GCA_934433485.1",
    "GB_GCA_012727485.1",
    "GB_GCA_022824545.1",
    "GB_GCA_002747135.1",
    "GB_GCA_018378255.1",
    "GB_GCA_024280495.1",
    "GB_GCA_016189945.1",
    "GB_GCA_902584445.1",
    "GB_GCA_021780755.1",
    "GB_GCA_023898665.1",
    "GB_GCA_009744115.1",
    "GB_GCA_017464985.1",
    "GB_GCA_934621705.1",
    "RS_GCF_000620085.1",
    "RS_GCF_008274625.1",
    "RS_GCF_000525915.1",
    "GB_GCA_023489135.1",
    "GB_GCA_934272745.1",
    "GB_GCA_020344335.1",
    "GB_GCA_017411605.1",
    "GB_GCA_017997825.1",
    "GB_GCA_022616415.1",
    "RS_GCF_016908515.1",
    "GB_GCA_002436025.1",
    "GB_GCA_002720485.1",
    "RS_GCF_002953655.1",
    "GB_GCA_902798915.1",
    "RS_GCF_000423425.1",
    "RS_GCF_004798585.1",
    "RS_GCF_017811815.1",
    "GB_GCA_905479795.1",
    "GB_GCA_012729015.1",
    "RS_GCF_003851545.1",
    "RS_GCF_001465345.1",
    "RS_GCF_900107125.1",
    "RS_GCF_005405225.1",
    "GB_GCA_013389055.1",
    "GB_GCA_022712475.1",
    "GB_GCA_002492415.1",
    "RS_GCF_009455625.1",
    "RS_GCF_021026315.1",
    "GB_GCA_021737405.1",
    "GB_GCA_903903985.1",
    "RS_GCF_004799755.1",
    "RS_GCF_009796865.1",
    "RS_GCF_900142755.1",
    "GB_GCA_020429235.1",
    "RS_GCF_900602065.1",
    "GB_GCA_003223395.1",
    "RS_GCF_003992625.1",
    "RS_GCF_000511355.1",
    "RS_GCF_019091085.1",
    "RS_GCF_002288635.1",
    "GB_GCA_016926405.1",
    "RS_GCF_900110375.1",
    "GB_GCA_013360405.1",
    "GB_GCA_903848645.1",
    "GB_GCA_016302225.1",
    "RS_GCF_012927275.1",
    "GB_GCA_004555405.1",
    "GB_GCA_003554945.1",
    "GB_GCA_017651785.1",
    "GB_GCA_016929805.1",
    "RS_GCF_004353225.1",
    "GB_GCA_023260815.1",
    "RS_GCF_000427665.1",
    "GB_GCA_013153675.1",
    "GB_GCA_020636155.1",
    "GB_GCA_003242495.1",
    "RS_GCF_004354915.1",
    "GB_GCA_009908425.1",
    "GB_GCA_021818335.1",
    "RS_GCF_016592595.1",
    "GB_GCA_902836725.1",
    "GB_GCA_012965485.1",
    "RS_GCF_001886185.1",
    "GB_GCA_016292515.1",
    "GB_GCA_017743275.1",
    "GB_GCA_018334855.1",
    "GB_GCA_017450605.1",
    "GB_GCA_021204765.1",
    "GB_GCA_903892365.1",
    "GB_GCA_019233825.1",
    "RS_GCF_003946045.1",
    "RS_GCF_003384725.1",
    "RS_GCF_017921815.1",
    "RS_GCF_000320405.1",
    "GB_GCA_003241825.1",
    "GB_GCA_012514145.1",
    "GB_GCA_024699425.1",
    "GB_GCA_902803075.1",
    "GB_GCA_017542305.1",
    "GB_GCA_008080835.1",
    "GB_GCA_001828935.1",
    "GB_GCA_017470505.1",
    "GB_GCA_003258405.1",
    "GB_GCA_011046415.1",
    "GB_GCA_018971775.1",
    "GB_GCA_016288775.1",
    "GB_GCA_011620215.1",
    "GB_GCA_002457475.1",
    "GB_GCA_002457305.1",
    "GB_GCA_024277325.1",
    "GB_GCA_017517985.1",
    "GB_GCA_016841555.1",
    "GB_GCA_017614625.1",
    "RS_GCF_007754425.1",
    "GB_GCA_019090795.1",
    "RS_GCF_017650195.1",
    "GB_GCA_902547215.1",
    "GB_GCA_017559885.1",
    "GB_GCA_024685005.1",
    "RS_GCF_020171985.1",
    "RS_GCF_900142225.1",
    "RS_GCF_007671655.1",
    "GB_GCA_001871085.1",
    "GB_GCA_902573755.1",
    "GB_GCA_024405815.1",
    "GB_GCA_009783495.1",
    "GB_GCA_020446425.1",
    "RS_GCF_943914805.1",
    "GB_GCA_905373385.1",
    "GB_GCA_021732495.1",
    "GB_GCA_003501335.1",
    "RS_GCF_000260985.4",
    "GB_GCA_943357175.1",
    "GB_GCA_024276955.1",
    "GB_GCA_017432075.1",
    "RS_GCF_900475285.1",
    "RS_GCF_020829495.1",
    "RS_GCF_004770055.1",
    "GB_GCA_905616435.1",
    "GB_GCA_017508135.1",
    "GB_GCA_005879505.1",
    "GB_GCA_900143635.1",
    "RS_GCF_001945445.1",
    "GB_GCA_902537325.1",
    "GB_GCA_016744295.1",
    "GB_GCA_023457715.1",
    "GB_GCA_003242275.1",
    "GB_GCA_019636385.1",
    "GB_GCA_015067725.1",
    "GB_GCA_003139545.1",
    "GB_GCA_003660235.1",
    "GB_GCA_016183945.1",
    "GB_GCA_005889475.1",
    "GB_GCA_018609785.1",
    "GB_GCA_002683735.1",
    "GB_GCA_903860995.1",
    "GB_GCA_015484575.1",
    "RS_GCF_000306885.1",
    "GB_GCA_002412885.1",
    "GB_GCA_020635395.1",
    "GB_GCA_002405555.1",
    "GB_GCA_021787935.1",
    "RS_GCF_003967555.1",
    "GB_GCA_902810745.1",
    "GB_GCA_021795255.1",
    "GB_GCA_021827245.1",
    "GB_GCA_013152315.1",
    "RS_GCF_011304195.1",
    "GB_GCA_021811305.1",
    "GB_GCA_017453505.1",
    "RS_GCF_904846415.1",
    "RS_GCF_000219125.1",
    "GB_GCA_005809115.1",
    "GB_GCA_902632575.1",
    "GB_GCA_011174845.1",
    "RS_GCF_900626285.1",
    "GB_GCA_016720935.1",
    "GB_GCA_023450775.1",
    "GB_GCA_017997315.1",
    "GB_GCA_014132315.1",
    "GB_GCA_913046825.1",
    "RS_GCF_011174675.1",
    "GB_GCA_021107755.1",
    "GB_GCA_021734475.1",
    "GB_GCA_903876745.1",
    "GB_GCA_017508045.1",
    "GB_GCA_012839395.1",
    "GB_GCA_015485895.1",
    "RS_GCF_002554705.1",
    "GB_GCA_020024255.1",
    "GB_GCA_002163975.1",
    "GB_GCA_016196505.1",
    "GB_GCA_017395725.1",
    "RS_GCF_003201935.1",
    "GB_GCA_013203195.1",
    "RS_GCF_017794765.1",
    "GB_GCA_902568425.1",
    "GB_GCA_022703645.1",
    "RS_GCF_004138335.1",
    "GB_GCA_003535475.1",
    "GB_GCA_017416145.1",
    "GB_GCA_016713175.1",
    "GB_GCA_021776115.1",
    "GB_GCA_012799845.1",
    "RS_GCF_913777995.1",
    "RS_GCF_003634015.1",
    "GB_GCA_021769625.1",
    "GB_GCA_016187225.1",
    "RS_GCF_014349105.1",
    "GB_GCA_003331565.1",
    "GB_GCA_015662815.1",
    "GB_GCA_022768185.1",
    "GB_GCA_903885795.1",
    "GB_GCA_002408285.1",
    "GB_GCA_000995965.1",
    "GB_GCA_024233875.1",
    "GB_GCA_005879315.1",
    "GB_GCA_023439425.1",
    "GB_GCA_017632755.1",
    "GB_GCA_017465145.1",
    "GB_GCA_018241585.1",
    "RS_GCF_900129355.1",
    "GB_GCA_002482925.1",
    "GB_GCA_003519965.1",
    "GB_GCA_021795535.1",
    "GB_GCA_934746515.1",
    "GB_GCA_021790955.1",
    "GB_GCA_003561145.1",
    "GB_GCA_024277605.1",
    "GB_GCA_020721745.1",
    "GB_GCA_020627945.1",
    "RS_GCF_902806265.1",
    "RS_GCF_004339465.1",
    "GB_GCA_011390345.1",
    "RS_GCF_018687275.1",
    "RS_GCF_024029915.1",
    "GB_GCA_902797525.1",
    "GB_GCA_003818595.1",
    "RS_GCF_000483485.1",
    "RS_GCF_003609605.1",
    "GB_GCA_016712405.1",
    "GB_GCA_945788385.1",
    "GB_GCA_012729725.1",
    "RS_GCF_028736215.1",
    "RS_GCF_009883635.2",
    "GB_GCA_022563505.1",
    "GB_GCA_021732995.1",
    "RS_GCF_002204795.1",
    "GB_GCA_021772915.1",
    "GB_GCA_016218725.1",
    "GB_GCA_017440665.1",
    "GB_GCA_001803165.1",
    "RS_GCF_002954605.1",
    "RS_GCF_014205835.1",
    "RS_GCF_007667275.1",
    "RS_GCF_000287335.1",
    "GB_GCA_023393155.1",
    "GB_GCA_022774705.1",
    "GB_GCA_021813305.1",
    "RS_GCF_010646885.2",
    "RS_GCF_002871095.1",
    "GB_GCA_945862285.1",
    "GB_GCA_020726325.1",
    "GB_GCA_003695565.1",
    "GB_GCA_004297335.1",
    "GB_GCA_012800685.1",
    "GB_GCA_900766125.1",
    "GB_GCA_020217265.1",
    "GB_GCA_024696825.1",
    "GB_GCA_002369135.1",
    "RS_GCF_008369325.1",
    "GB_GCA_003280085.1",
    "GB_GCA_017479645.1",
    "RS_GCF_018860745.1",
    "GB_GCA_023356605.1",
    "RS_GCF_018383585.1",
    "GB_GCA_012689375.1",
    "GB_GCA_020627885.1",
    "GB_GCA_001321855.1",
    "GB_GCA_016784705.1",
    "GB_GCA_016789885.1",
    "GB_GCA_903917615.1",
    "GB_GCA_011391225.1",
    "GB_GCA_016926255.1",
    "RS_GCF_019443405.1",
    "RS_GCF_004006665.1",
    "GB_GCA_023245775.1",
    "RS_GCF_000384135.1",
    "RS_GCF_004332155.1",
    "GB_GCA_018649665.1",
    "RS_GCF_009380165.1",
    "GB_GCA_018700055.1",
    "GB_GCA_017646325.1",
    "RS_GCF_003012745.1",
    "GB_GCA_017508895.1",
    "GB_GCA_902798685.1",
    "GB_GCA_024711325.1",
    "GB_GCA_902784805.1",
    "GB_GCA_913041775.1",
    "RS_GCF_001435235.1",
    "RS_GCF_900109175.1",
    "RS_GCF_900106925.1",
    "GB_GCA_023458555.1",
    "RS_GCF_003399445.1",
    "RS_GCF_900101265.1",
    "RS_GCF_900100455.1",
    "GB_GCA_944323815.1",
    "RS_GCF_003095375.1",
    "RS_GCF_016316925.1",
    "GB_GCA_013822425.1",
    "RS_GCF_014635325.1",
    "RS_GCF_021390495.1",
    "GB_GCA_014360895.1",
    "GB_GCA_902526115.1",
    "GB_GCA_021108395.1",
    "GB_GCA_017560705.1",
    "GB_GCA_900552155.1",
    "GB_GCA_000993405.1",
    "GB_GCA_003165315.1",
    "GB_GCA_005883615.1",
    "GB_GCA_020060185.1",
    "RS_GCF_900106565.1",
    "GB_GCA_015067545.1",
    "GB_GCA_945860405.1",
    "GB_GCA_023255875.1",
    "GB_GCA_902571925.1",
    "GB_GCA_902567635.1",
    "GB_GCA_013696905.1",
    "GB_GCA_002483425.1",
    "RS_GCF_004342265.1",
    "RS_GCF_001982605.1",
    "GB_GCA_944321965.1",
    "GB_GCA_003171335.1",
    "GB_GCA_013201405.1",
    "GB_GCA_016931215.1",
    "GB_GCA_020445945.1",
    "RS_GCF_900112315.1",
    "GB_GCA_018883065.1",
    "GB_GCA_022785125.1",
    "GB_GCA_902797495.1",
    "GB_GCA_021204375.1",
    "GB_GCA_016937855.1",
    "RS_GCF_000576635.1",
    "GB_GCA_014380365.1",
    "RS_GCF_000425205.1",
    "GB_GCA_016195145.1",
    "GB_GCA_003476475.1",
    "GB_GCA_024278445.1",
    "GB_GCA_024682835.1",
    "GB_GCA_902620465.1",
    "GB_GCA_021768705.1",
    "GB_GCA_016869535.1",
    "RS_GCF_016429215.1",
    "GB_GCA_020346325.1",
    "GB_GCA_009920225.1",
    "RS_GCF_003628445.1",
    "GB_GCA_022508805.1",
    "GB_GCA_016186485.1",
    "GB_GCA_020050795.1",
    "GB_GCA_016210285.1",
    "GB_GCA_017434985.1",
    "RS_GCF_006980715.1",
    "RS_GCF_000815465.1",
    "GB_GCA_020723255.1",
    "GB_GCA_007693835.1",
    "GB_GCA_017466495.1",
    "RS_GCF_024606345.1",
    "GB_GCA_017523755.1",
    "GB_GCA_021740105.1",
    "RS_GCF_002155695.1",
    "RS_GCF_902499555.1",
    "GB_GCA_020725585.1",
    "GB_GCA_005888095.1",
    "GB_GCA_017464525.1",
    "GB_GCA_008015855.1",
    "GB_GCA_002721105.1",
    "GB_GCA_012517905.1",
    "GB_GCA_016125085.1",
    "RS_GCF_002806995.1",
    "RS_GCF_902497745.1",
    "RS_GCF_019746015.1",
    "GB_GCA_023419315.1",
    "GB_GCA_016183225.1",
    "GB_GCA_902797505.1",
    "GB_GCA_002747695.1",
    "GB_GCA_016190925.1",
    "RS_GCF_000239275.1",
    "RS_GCF_009908315.1",
    "GB_GCA_024397995.1",
    "GB_GCA_017514125.1",
    "RS_GCF_018861755.1",
    "GB_GCA_904378095.1",
    "RS_GCF_001647275.1",
    "GB_GCA_002748265.1",
    "GB_GCA_903857265.1",
    "RS_GCF_001434935.1",
    "GB_GCA_001464855.1",
    "GB_GCA_900315575.1",
    "GB_GCA_020723205.1",
    "GB_GCA_016281605.1",
    "GB_GCA_903869665.1",
    "GB_GCA_023412495.1",
    "GB_GCA_021163015.1",
    "RS_GCF_023502145.1",
    "GB_GCA_009692365.1",
    "GB_GCA_021734705.1",
    "RS_GCF_009789195.1",
    "GB_GCA_913058025.1",
    "GB_GCA_017519305.1",
    "GB_GCA_016929755.1",
    "GB_GCA_014764075.1",
    "GB_GCA_013389025.1",
    "GB_GCA_022072025.1",
    "GB_GCA_019359215.1",
    "GB_GCA_903970615.1",
    "GB_GCA_001782085.1",
    "GB_GCA_017429885.1",
    "RS_GCF_000472665.1",
    "GB_GCA_012518815.1",
    "GB_GCA_021201565.1",
    "GB_GCA_017481115.1",
    "GB_GCA_021734665.1",
    "GB_GCA_002717225.1",
    "RS_GCF_000185805.1",
    "GB_GCA_023250195.1",
    "RS_GCF_014859695.1",
    "GB_GCA_023247195.1",
    "GB_GCA_934444895.1",
    "GB_GCA_902604005.1",
    "GB_GCA_944391005.1",
    "GB_GCA_013297565.1",
    "GB_GCA_024679635.1",
    "GB_GCA_003223515.1",
    "RS_GCF_014207355.1",
    "GB_GCA_015487335.1",
    "RS_GCF_000380145.1",
    "GB_GCA_020725145.1",
    "GB_GCA_017532485.1",
    "GB_GCA_024697945.1",
    "GB_GCA_002345725.1",
    "GB_GCA_913055685.1",
    "GB_GCA_902541695.1",
    "GB_GCA_903915535.1",
    "GB_GCA_017504205.1",
    "GB_GCA_024637095.1",
    "RS_GCF_000519305.1",
    "GB_GCA_023421955.1",
    "GB_GCA_019217005.1",
    "GB_GCA_902589765.1",
    "GB_GCA_015484595.1",
    "GB_GCA_023435565.1",
    "GB_GCA_905233375.1",
    "RS_GCF_022664395.1",
    "GB_GCA_002869465.1",
    "GB_GCA_902557935.1",
    "RS_GCF_000384475.1",
    "GB_GCA_018649885.1",
    "GB_GCA_003521145.1",
    "RS_GCF_002091475.1",
    "GB_GCA_001872945.1",
    "GB_GCA_903867225.1",
    "RS_GCF_018139985.1",
    "RS_GCF_013607485.1",
    "RS_GCF_021012795.1",
    "GB_GCA_021790855.1",
    "RS_GCF_001723295.1",
    "RS_GCF_010692395.1",
    "GB_GCA_022729835.1",
    "GB_GCA_012841535.1",
    "GB_GCA_003562655.1",
    "GB_GCA_022648685.1",
    "RS_GCF_000373985.1",
    "RS_GCF_016744175.1",
    "GB_GCA_016217835.1",
    "GB_GCA_902766755.1",
    "GB_GCA_017647725.1",
    "GB_GCA_015663855.1",
    "GB_GCA_016927395.1",
    "GB_GCA_002693745.1",
    "RS_GCF_900129325.1",
    "GB_GCA_013286645.1",
    "GB_GCA_023423835.1",
    "GB_GCA_016929905.1",
    "GB_GCA_017472115.1",
    "RS_GCF_005144415.1",
    "GB_GCA_021203365.1",
    "RS_GCF_023559245.1",
    "GB_GCA_902774015.1",
    "GB_GCA_002699335.1",
    "GB_GCA_021730905.1",
    "GB_GCA_934589155.1",
    "RS_GCF_009765445.1",
    "RS_GCF_019683635.1",
    "RS_GCF_000935215.1",
    "GB_GCA_020852375.1",
    "RS_GCF_001677955.1",
    "GB_GCA_020073285.1",
    "GB_GCA_902774525.1",
    "GB_GCA_021815835.1",
    "GB_GCA_021648365.1",
    "GB_GCA_016195805.1",
    "GB_GCA_002084535.1",
    "RS_GCF_001704115.1",
    "GB_GCA_010028775.1",
    "GB_GCA_016185185.1",
    "RS_GCF_007995095.1",
    "GB_GCA_002307905.1",
    "GB_GCA_021768185.1",
    "GB_GCA_024413465.1",
    "GB_GCA_018715965.1",
    "RS_GCF_900112005.1",
    "RS_GCF_001483135.1",
    "GB_GCA_016933045.1",
    "GB_GCA_020853775.1",
    "GB_GCA_017964485.1",
    "GB_GCA_018066865.1",
    "RS_GCF_009765685.1",
    "GB_GCA_022447685.1",
    "RS_GCF_001578875.1",
    "RS_GCF_024170005.1",
    "GB_GCA_017465665.1",
    "GB_GCA_902168115.1",
    "RS_GCF_020832325.1",
    "RS_GCF_008033385.1",
    "GB_GCA_024685565.1",
    "GB_GCA_013698215.1",
    "GB_GCA_014804345.1",
    "GB_GCA_017853385.1",
    "RS_GCF_006715975.1",
    "GB_GCA_013288685.1",
    "GB_GCA_019689955.1",
    "GB_GCA_945788485.1",
    "RS_GCF_019801215.1",
    "RS_GCF_018889955.1",
    "GB_GCA_017643965.1",
    "GB_GCA_944323115.1",
    "GB_GCA_023251195.1",
    "GB_GCA_021775105.1",
    "GB_GCA_003641745.1",
    "GB_GCA_024692905.1",
    "RS_GCF_004016445.2",
    "GB_GCA_012840535.1",
    "GB_GCA_019348515.1",
    "GB_GCA_902761225.1",
    "GB_GCA_017517685.1",
    "GB_GCA_905373625.1",
    "RS_GCF_900100355.1",
    "GB_GCA_009928785.1",
    "GB_GCA_001772625.1",
    "RS_GCF_003231495.1",
    "RS_GCF_012849375.1",
    "GB_GCA_944388415.1",
    "GB_GCA_024403155.1",
    "RS_GCF_012641365.1",
    "GB_GCA_013151855.1",
    "RS_GCF_000017565.1",
    "GB_GCA_020638055.1",
    "RS_GCF_020966635.1",
    "GB_GCA_022841245.1",
    "GB_GCA_022615595.1",
    "GB_GCA_009783415.1",
    "GB_GCA_015232535.1",
    "GB_GCA_003577315.1",
    "GB_GCA_019114715.1",
    "GB_GCA_002411085.1",
    "GB_GCA_012520995.1",
    "GB_GCA_002862095.1",
    "GB_GCA_903898475.1",
    "GB_GCA_012103325.1",
    "GB_GCA_021404785.1",
    "GB_GCA_017481595.1",
    "GB_GCA_016703525.1",
    "GB_GCA_902796985.1",
    "GB_GCA_017520155.1",
    "GB_GCA_001443545.1",
    "GB_GCA_016869215.1",
    "GB_GCA_002314835.1",
    "RS_GCF_003317055.1",
    "GB_GCA_902560875.1",
    "GB_GCA_024763475.1",
    "GB_GCA_900764225.1",
    "GB_GCA_018334525.1",
    "GB_GCA_017475485.1",
    "GB_GCA_944386865.1",
    "GB_GCA_003132825.1",
    "RS_GCF_002933875.1",
    "GB_GCA_015065285.1",
    "GB_GCA_019415525.1",
    "GB_GCA_017511865.1",
    "GB_GCA_005788235.1",
    "GB_GCA_016297495.1",
    "GB_GCA_023229365.1",
    "GB_GCA_903970425.1",
    "RS_GCF_003254505.1",
    "GB_GCA_002694895.1",
    "GB_GCA_002435705.1",
    "RS_GCF_008085915.1",
    "GB_GCA_903830915.1",
    "GB_GCA_015069135.1",
    "GB_GCA_002422365.1",
    "GB_GCA_022842245.1",
    "GB_GCA_016713135.1",
    "GB_GCA_002317475.1",
    "GB_GCA_919902475.1",
    "GB_GCA_019459145.1",
    "GB_GCA_013359345.1",
    "RS_GCF_014841135.1",
    "GB_GCA_021299355.1",
    "GB_GCA_020845855.1",
    "GB_GCA_018829245.1",
    "GB_GCA_016901395.1",
    "GB_GCA_002928965.1",
    "GB_GCA_002402165.1",
    "GB_GCA_003281315.1",
    "RS_GCF_000025265.1",
    "GB_GCA_900768265.1",
    "GB_GCA_001464315.1",
    "GB_GCA_018061685.1",
    "RS_GCF_014647195.1",
    "RS_GCF_008629675.1",
    "GB_GCA_001783275.1",
    "GB_GCA_003157715.1",
    "GB_GCA_017995665.1",
    "GB_GCA_017510065.1",
    "RS_GCF_003013395.1",
    "RS_GCF_009792355.1",
    "GB_GCA_016198905.1",
    "GB_GCA_003635265.1",
    "GB_GCA_945901725.1",
    "RS_GCF_003952365.1",
    "GB_GCA_021648725.1",
    "GB_GCA_025062175.1",
    "RS_GCF_900128885.1",
    "RS_GCF_005503015.1",
    "GB_GCA_005879795.1",
    "GB_GCA_017521065.1",
    "GB_GCA_003245815.1",
    "GB_GCA_017414845.1",
    "RS_GCF_009901585.1",
    "RS_GCF_900536025.1",
    "RS_GCF_900111595.1",
    "GB_GCA_015062585.1",
    "GB_GCA_002306375.1",
    "RS_GCF_002100115.1",
    "GB_GCA_017620025.1",
    "GB_GCA_020639155.1",
    "GB_GCA_020634755.1",
    "GB_GCA_012523945.1",
    "GB_GCA_015232015.1",
    "GB_GCA_024698075.1",
    "GB_GCA_012799265.1",
    "GB_GCA_905234265.1",
    "GB_GCA_018401955.1",
    "GB_GCA_003233475.1",
    "GB_GCA_900769765.1",
    "GB_GCA_944372565.1",
    "RS_GCF_900169565.1",
    "GB_GCA_015064685.1",
    "GB_GCA_002315735.1",
    "GB_GCA_934234275.1",
    "GB_GCA_003235325.1",
    "GB_GCA_025059995.1",
    "GB_GCA_944386055.1",
    "RS_GCF_019061305.1",
    "RS_GCF_024742075.1",
    "RS_GCF_014212495.1",
    "GB_GCA_022703055.1",
    "GB_GCA_024690965.1",
    "GB_GCA_011390075.1",
    "GB_GCA_003696975.1",
    "RS_GCF_022440845.1",
    "RS_GCF_003751505.1",
    "GB_GCA_023249375.1",
    "RS_GCF_902159415.1",
    "GB_GCA_020048105.1",
    "GB_GCA_002341315.1",
    "GB_GCA_902616145.1",
    "GB_GCA_017410195.1",
    "GB_GCA_018968885.1",
    "GB_GCA_016181175.1",
    "GB_GCA_019237945.1",
    "RS_GCF_014638915.1",
    "GB_GCA_018065205.1",
    "RS_GCF_018131005.1",
    "RS_GCF_001427285.1",
    "GB_GCA_002840715.1",
    "GB_GCA_021199695.1",
    "GB_GCA_019359715.1",
    "GB_GCA_017627955.1",
    "GB_GCA_002383405.1",
][:40]

from typing import Callable
import torch
from ete3 import Tree
from multiprocessing import Pool
from tqdm import tqdm


def _compute_distance_chunk_cached(args):
    """Worker function with cached node lookups."""
    row_indices, accession_ids, tree_path = args

    tree = Tree(tree_path, format=1, quoted_node_names=True)

    # Cache all node lookups and root distances once per worker
    node_cache = {}
    root_dist_cache = {}

    for acc_id in accession_ids:
        try:
            nodes = tree.search_nodes(name=acc_id)
            if nodes:
                node_cache[acc_id] = nodes[0]
                root_dist_cache[acc_id] = nodes[0].get_distance(tree)
            else:
                node_cache[acc_id] = None
        except:
            node_cache[acc_id] = None

    results = []
    with tqdm(total=len(row_indices) * (len(accession_ids) - 1) // 2) as pbar:
        pbar.set_description(f"Processing rows {row_indices[0]} to {row_indices[-1]}")
        for i in row_indices:
            for j in range(i + 1, len(accession_ids)):
                node_i = node_cache.get(accession_ids[i])
                node_j = node_cache.get(accession_ids[j])

                if node_i is None or node_j is None:
                    dist = float("nan")
                else:
                    # Get LCA and calculate distance via root
                    lca = tree.get_common_ancestor([node_i, node_j])
                    lca_dist = lca.get_distance(tree)
                    dist = (
                        root_dist_cache[accession_ids[i]]
                        + root_dist_cache[accession_ids[j]]
                        - 2 * lca_dist
                    )

                results.append((i, j, dist))
                pbar.update(1)

    return results


def _compute_distance_chunk(args):
    """Worker function to compute distances for a chunk of row indices."""
    row_indices, accession_ids, tree_path = args

    # Each worker loads its own tree
    tree = Tree(tree_path, format=1, quoted_node_names=True)
    leaves = tree.get_leaf_names()

    results = []
    with tqdm(total=len(row_indices) * (len(accession_ids) - 1) // 2) as pbar:
        pbar.set_description(f"Processing rows {row_indices[0]} to {row_indices[-1]}")
        for i in row_indices:
            for j in range(i + 1, len(accession_ids)):
                if accession_ids[i] in leaves and accession_ids[j] in leaves:
                    dist = tree.get_distance(accession_ids[i], accession_ids[j])
                else:
                    dist = float("nan")
                results.append((i, j, dist))
                pbar.update(1)

    return results


def mp_phylogenetic_distance_matrix(
    accession_ids: list[str],
    tree_path: str,
    n_processes: int = 12,
    distance_func: Callable = None,
) -> torch.Tensor:
    """Compute pairwise phylogenetic distances using multiprocessing."""
    n = len(accession_ids)
    distance_matrix = torch.zeros((n, n), dtype=torch.float32)

    # Divide rows among workers
    chunk_size = n // n_processes
    chunks = []
    for proc in range(n_processes):
        start = proc * chunk_size
        end = n if proc == n_processes - 1 else (proc + 1) * chunk_size
        row_indices = list(range(start, end))
        chunks.append((row_indices, accession_ids, tree_path))

    # Process in parallel
    with Pool(processes=n_processes) as pool:
        results = tqdm(pool.imap(distance_func, chunks), total=len(chunks))

    # Fill the matrix
    for chunk_results in results:
        for i, j, dist in chunk_results:
            distance_matrix[i, j] = dist
            distance_matrix[j, i] = dist

    return distance_matrix


# compare performance

from time import perf_counter

tree_path = "/root/evo2-mech-interp/data/gtdb/bac120_r220.tree"


start_time = perf_counter()
distance_matrix_old = _compute_distance_chunk(
    (list(range(len(accession_ids))), accession_ids, tree_path)
)
end_time = perf_counter()

print(f"Time taken for old: {end_time - start_time:.2f} seconds")

start_time = perf_counter()
distance_matrix_new = _compute_distance_chunk_cached(
    (list(range(len(accession_ids))), accession_ids, tree_path)
)
end_time = perf_counter()

print(f"Time taken for new: {end_time - start_time:.2f} seconds")

assert torch.allclose(
    torch.tensor([dist for _, _, dist in distance_matrix_old]),
    torch.tensor([dist for _, _, dist in distance_matrix_new]),
    equal_nan=True,
), "Distance matrices do not match!"
